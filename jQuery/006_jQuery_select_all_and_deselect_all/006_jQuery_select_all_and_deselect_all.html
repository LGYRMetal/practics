<!doctype html>
<html>
    <head>
        <title>Select all and deselect all</title>
        <meta http-equiv="Content-Type"
              content="text/html; charset=utf-8" />

        <script type="text/javascript"
                src="../../../jQuery/jquery-1.12.4.min.js"></script>

        <script type="text/javascript">
            var checked = false;
            function checkAllOrNot() {
                var v_subCheckboxes = $("br ~ input");

                if(checked) {
                    //alert("if");
                    for(var i=0; i < v_subCheckboxes.length; i++) {
                        //alert($(v_subCheckboxes[i]).attr("checked"));
                        //$(v_subCheckboxes[i]).removeAttr("checked");
                        //$(v_subCheckboxes[i]).attr("checked", false);
                        $(v_subCheckboxes[i]).prop("checked", false);
                        //alert($(v_subCheckboxes[i]).attr("checked"));
                        //v_subCheckboxes[i].checked = false;
                    }
                    checked = false;
                } else {
                    //alert("else");
                    for(var i=0; i < v_subCheckboxes.length; i++) {
                        //alert($(v_subCheckboxes[i]).attr("checked"));
                        //$(v_subCheckboxes[i]).attr("checked", true);
                        $(v_subCheckboxes[i]).prop("checked", true);
                        //alert($(v_subCheckboxes[i]).attr("checked"));
                        //v_subCheckboxes[i].checked = true;
                    }
                    checked = true;
                }
            }
        </script>
    </head>

    <body>
        <span id="text">全选</span>
        <input type="checkbox" id="main" onclick="checkAllOrNot();" />
        <br />
        北京 <input type="checkbox" /><br />
        上海 <input type="checkbox" /><br />
        天津 <input type="checkbox" /><br />
    </body>
</html>
